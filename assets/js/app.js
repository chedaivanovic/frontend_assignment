let getId=e=>document.getElementById(e),getClass=e=>document.getElementsByClassName(e),crEl=e=>document.createElement(e),empty=e=>{e.innerHTML=""},currentPage=1,theBook={selected_genre:"",selected_subgenre:"",book_title:"",book_author:"",book_ISBN:"",book_publisher:"",book_date:"",book_pagesno:"",book_format:"",book_edition:"",book_lang:"",book_description:""},newBtn={id:"0",name:"New",new_name:"",isDescriptionRequired:""},authors=[{name:"Beck Villanueva",id:"1"},{name:"Anastasia Morales",id:"2"},{name:"Shelby Larsen",id:"3"},{name:"Sheikh Fuentes",id:"4"},{name:"Ishaq Nieves",id:"5"},{name:"Mohsin Gamble",id:"6"},{name:"Hugo Finney",id:"7"},{name:"Viola Britton",id:"8"},{name:"Rumaisa James",id:"9"},{name:"Jasleen Bright",id:"10"}],publishers=[{name:"Super Books",id:"1"},{name:"Star Books",id:"2"},{name:"Read&Advance",id:"3"}],formats=[{name:"A4",id:"1"},{name:"A5",id:"2"},{name:"A2",id:"3"}],langs=[{name:"Serbian",id:"1"},{name:"Deutch",id:"2"},{name:"English",id:"3"}],createButton=(e,t="disabled")=>{let o=crEl("input");o.classList.add("global-button",`${t}-button`),o.setAttribute("type","radio"),o.id=`${"new"===t?"subgenre":t}-${e.id}`,o.setAttribute("name",`select-${"new"===t?"subgenre":t}`),o.value=e.id;let n=crEl("label");n.setAttribute("for",`${"new"===t?"subgenre":t}-${e.id}`),n.innerHTML=e.name,appBody.append(o,n)};const appHolder=getId("app"),appHeading=getId("app-heading"),appBody=getId("app-body"),appFooter=getId("app-footer"),appSuccess=getId("app-success");fetch("/data/data.json").then((e=>e.json())).then((e=>{let t=e=>{let t=crEl("button");t.classList.add("footer-btn","footer-btn-back"),t.id="back-btn",t.type="button",t.innerHTML="Back",t.addEventListener("click",(e=>{switch(currentPage){case 4:currentPage--,l();break;case 3:currentPage--,i(theBook.selected_genre);break;case 2:currentPage--,r()}})),e.append(t)},o=t=>{let o=crEl("button");o.classList.add("disabled","footer-btn","footer-btn-next"),o.disabled=!0,o.id="next-btn",o.innerHTML="Next",o.addEventListener("click",(()=>{let t;switch(currentPage){case 1:t="genre";break;case 2:t="subgenre";break;default:t="nogenre"}let o,n=appBody.querySelector(`input[name="select-${t}"]:checked`);switch(n?o=parseInt(n.value):(o=getClass("subgenre-input")[0].value,theBook.selected_subgenre=o,newBtn.new_name=o,getId("new-subgenred-req-check").checked?newBtn.isDescriptionRequired=!0:newBtn.isDescriptionRequired=!1,currentPage++,b(newBtn)),currentPage){case 1:currentPage++;const t=e.genres.find((e=>e.id===parseInt(o)));i(t);break;case 2:if(currentPage++,0===o)l();else{const e=theBook.selected_genre.subgenres.find((e=>e.id===parseInt(o)));b(e)}}})),t.append(o)},n=(e,t,o,n,a,s="",d=!1)=>{let r=crEl(t);if(r.type=o,r.id=a,"select"===t){r.placeholder=n;for(let e of s){let t=crEl("option");t.value=e.id,t.innerHTML=e.name,r.append(t)}}else"date"!=o?r.placeholder=n:r.max=(new Date).toISOString().split("T")[0];"textarea"===t&&!0===d?r.setAttribute("required",d):"checkbox"===o?r.setAttribute("required",!1):"number"===o?r.min=1:"textarea"!=t&&r.setAttribute("required",!0);let i=crEl("label");i.classList.add("unstyled-label"),i.setAttribute("for",a),i.innerHTML=n,"checkbox"===o?(e.append(r),e.append(i)):(e.append(i),e.append(r))},a=()=>{getId("next-btn").removeAttribute("disabled"),getId("next-btn").classList.remove("disabled")},s=()=>{let e=currentPage,t=getClass("breadcrumb");for(let e of t)e.classList.contains("bc-active")&&e.classList.remove("bc-active");let o=getClass(`breadcrumb-${e}`);for(cpBc of o)cpBc.classList.add("bc-active")},d=()=>{getId("breadcrumbs-long").style.display="none",getId("breadcrumbs-short").style.display="none",getId("breadcrumb-dots").style.display="flex"},r=()=>{for(genre of(empty(appBody),empty(appFooter),e.genres))createButton(genre,"genre"),getId(`genre-${genre.id}`).addEventListener("click",(()=>{1==getId("next-btn").disabled&&a()}));d(),s(),o(appFooter)},i=e=>{for(subgenre of(theBook.selected_genre=e,empty(appBody),empty(appFooter),e.subgenres))createButton(subgenre,"subgenre"),getId(`subgenre-${subgenre.id}`).addEventListener("click",(()=>{1==getId("next-btn").disabled&&a()}));createButton(newBtn,"new"),getId("subgenre-0").addEventListener("click",(()=>{1==getId("next-btn").disabled&&a()})),d(),s(),t(appFooter),o(appFooter)},l=()=>{empty(appBody),empty(appFooter);let e=crEl("input");e.type="text",e.classList.add("subgenre-input"),e.placeholder="Subgenre name",e.setAttribute("required",!0),appBody.append(e),n(appBody,"input","checkbox","Description is requiered for this subgenre","new-subgenred-req-check"),t(appFooter),o(appFooter);let d=getClass("subgenre-input")[0];d.addEventListener("keyup",(()=>{d.value.length>2&&document.getElementById("next-btn").classList.contains("disabled")?a():d.value.length<=2&&!document.getElementById("next-btn").classList.contains("disabled")&&(getId("next-btn").setAttribute("disabled",!0),getId("next-btn").classList.add("disabled"))})),getId("breadcrumb-dots").style.display="none",getId("breadcrumbs-short").style.display="none",getId("breadcrumbs-long").style.display="flex",s()},b=e=>{theBook.selected_subgenre=e;let o=!1;!0===e.isDescriptionRequired&&(o=!0),empty(appBody),empty(appFooter);let a=crEl("form");a.id="book-form",a.setAttribute("method","POST"),a.setAttribute("action","postbook.js"),n(a,"input","text","Book Title","book-title"),n(a,"input","text","Book Author","book-author"),n(a,"input","text","ISBN","book-isbn"),n(a,"select","text","Publisher","select-publisher",publishers),n(a,"input","date","Date published","book-date"),n(a,"input","number","Number of pages","book-pages"),n(a,"select","text","Book format","select-format",formats),n(a,"input","number","Edition","book-edition"),n(a,"select","text","Book language","select-lang",langs),n(a,"textarea","text","Description","book-description","",o);let d=crEl("div");d.classList.add("form-footer-btns"),t(d),(e=>{let t=crEl("input");t.classList.add("footer-btn","footer-btn-add"),t.id="add-btn",t.value="Add",t.type="submit",e.append(t)})(d),a.append(d),appBody.append(a),"none"===getId("breadcrumbs-long").style.display&&(getId("breadcrumb-dots").style.display="none",getId("breadcrumbs-long").style.display="none",getId("breadcrumbs-short").style.display="flex"),s(),getId("book-form").addEventListener("submit",(function(e){e.preventDefault(),""!=newBtn.new_name&&(theBook.selected_subgenre.name=newBtn.new_name),theBook.book_title=getId("book-title").value,theBook.book_author=getId("book-author").value,theBook.book_ISBN=getId("book-isbn").value,theBook.book_publisher=publishers.find((e=>e.id===getId("select-publisher").value)).name,theBook.book_date=getId("book-date").value,theBook.book_pagesno=getId("book-pages").value,theBook.book_format=formats.find((e=>e.id===getId("select-format").value)).name,theBook.book_edition=getId("book-edition").value,theBook.book_lang=langs.find((e=>e.id===getId("select-lang").value)).name,theBook.book_description=""!=getId("book-description").value?getId("book-description").value:"User did not enter the description for this Book!",console.log("NEW BOOK INPUT!","\n",`Book Name: ${theBook.book_title}`,"\n",`Book author: ${theBook.book_author}`,"\n",`Genre & Subgenre: ${theBook.selected_genre.name}, ${theBook.selected_subgenre.name}`,"\n",`Book ISBN: ${theBook.book_ISBN}`,"\n",`Book Publisher: ${theBook.book_publisher}`,"\n",`Book publish date: ${theBook.book_date}`,"\n",`Number of pages: ${theBook.book_pagesno} pages`,"\n",`Book Format: ${theBook.book_format}`,"\n",`Edition: ${theBook.book_edition}`,"\n",`Edition Language: ${theBook.book_lang}`,"\n",`Short description: ${theBook.book_description}`),getId("app").style.display="none",getId("app-success").style.display="block",getId("button-success").addEventListener("click",(()=>{theBook={selected_genre:"",selected_subgenre:"",book_title:"",book_author:"",book_ISBN:"",book_publisher:"",book_date:"",book_pagesno:"",book_format:"",book_edition:"",book_lang:"",book_description:""},newBtn.name="New",newBtn.new_name="",newBtn.isDescriptionRequired="",currentPage=1,r(),getId("app-success").style.display="none",getId("app").style.display="block"}))}))};r()}));